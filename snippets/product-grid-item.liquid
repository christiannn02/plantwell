{%- assign on_sale = false -%}
{%- if product.compare_at_price > product.price -%}
{%- assign on_sale = true -%}
{%- endif -%}

{%- assign sold_out = true -%}
{%- if product.available -%}
{%- assign sold_out = false -%}
{%- endif -%}

{%- assign variant = product.selected_or_first_available_variant -%}

{%- if product.available -%}
{%- assign func = "Shopify.addItem(" | append: variant.id | append: ", 1)" -%}
{%- endif -%} 

{%- capture product_fixed_text -%}
{%- if settings.hover_fixed_content -%}
 fixed_content
{%- endif -%}
{%- endcapture -%}

{%- capture product_content_align -%}
  {%- if settings.product_content_align == "right" -%}
  text-right
  {%- elsif settings.product_content_align == "center" -%}
  text-center
  {%- endif -%}
{%- endcapture -%}



<div class="single-product {{ product_fixed_text }} {{ variant.id }} {% if settings.countdown_timer_enable == true and product.description contains '[countdown]' %} countdownprod {% endif %} {% if sold_out %} sold_out_prod {% endif %} {% unless settings.product_cart_action_enable %} no_cart_button {% endunless %}">
  <div class="single-product__image">
     {%- include 'product-image-src' -%}    
    <div class="single-product__floating-badges">
       {%- include 'product-badge' -%}
    </div>

    <div class="single-product__floating-icons">
      {%- if settings.product_wishlist_enable -%}
      <span class="wishlist_inner">
      	{%- include 'wishlist-button' -%}
      </span>
      {%- endif -%}
      
      {%- if settings.product_compare_enable -%}
      <span class="compare"><a  href="#" data-tippy-content="{{ settings.compare_product_title }}" data-tippy-inertia="true" data-tippy-animation="shift-away" data-tippy-delay="50" data-tippy-arrow="true" data-tippy-theme = "sharpborder" data-tippy-placement = "{% if settings.rtl_enable %}right{% else %}left{% endif %}"  class="compare" data-pid="{{ product.handle  }}"><i class="ion-ios-shuffle-strong"></i></a> </span>
      {%- endif -%}
      {%- unless product.description contains '[affiliate_link]' -%}
      {%- if settings.product_quickview_enalbe -%}
      <span class="quickview">
        <a data-toggle="modal" data-target="#quickViewModal" href="javascript:void(0);" onclick="quiqview('{{ product.handle | handleize }}')"  data-tippy-content="{{ settings.product_quick_view_title }}" data-tippy-inertia="true" data-tippy-animation="shift-away" data-tippy-delay="50" data-tippy-arrow="true" data-tippy-theme = "sharpborder" data-tippy-placement = "{% if settings.rtl_enable %}right{% else %}left{% endif %}"  ><svg xmlns="http://www.w3.org/2000/svg" style="margin-left: 10px;" width="24" height="24" viewBox="0 0 24 24"><path d="M16.871 4.312c-.282-.764-1.01-1.312-1.871-1.312-1.298 0-2.313 1.244-1.904 2.582 1.111-.395 2.346-1.103 3.775-1.27zm-3.871 8.688c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm5.318 4.873c1.463-.311 2.471-1.49 2.146-3.227 1.399 1.517-.155 3.949-2.146 3.227zm-14.001 0c1.463-.311 2.471-1.49 2.146-3.227 1.399 1.517-.156 3.949-2.146 3.227zm4.683-14.873c-.861 0-1.589.548-1.871 1.312 1.429.168 2.664.875 3.775 1.27.409-1.338-.606-2.582-1.904-2.582zm1.134 5.494c1.208.396 2.517.398 3.731 0 2.615-.854 3.515-1.986 4.452-.331.392.691 1.332 2.337 1.665 2.934-2.854-.575-5.572 1.416-5.94 4.254-1.233-.62-2.794-.647-4.084 0-.369-2.839-3.086-4.829-5.941-4.254.414-.738 1.183-2.081 1.665-2.933.936-1.655 1.834-.526 4.452.33zm7.171-3.175c-1.393 0-2.86.881-4.062 1.274-.812.266-1.685.263-2.486 0-1.201-.393-2.669-1.274-4.062-1.274-.998 0-1.958.452-2.754 1.859-2.406 4.255-3.941 6.687-3.941 8.822 0 2.761 2.238 5 5 5 4.039 0 4.156-4.123 7-4.123s2.961 4.123 7 4.123c2.762 0 5-2.239 5-5 0-2.135-1.535-4.567-3.941-8.821-.797-1.408-1.756-1.86-2.754-1.86zm1.695 13.681c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3zm-14 0c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3z"/></svg></a></span>
      {%- endif -%}
      {%- endunless -%}
    </div>
    {% if product.variants.size > 1 and settings.product_variants_show %}
    <div class="single-product__variations">
        {% include 'product-size-variant' %}
        {% include 'product-color-variant' %}
    </div>
    {% endif %}
    
    {% if product.description contains '[countdown]' and settings.countdown_timer_enable %}
    {% assign count_down_first = product.description | split:'[/countdown]' | first %}
    {% assign count_down_final = count_down_first | split:'[countdown]' | last %}
    <div class="product_timer">
      <div data-countdown="{{ count_down_final }}"></div> 
    </div>
    {% endif %}
  </div>
  <div class="single-product__content {{ product_content_align }}">
    <div class="title">
      <h3 class="popup_cart_title">  <a href="{{ product.url | within: collection }}">{{ product.title }}</a></h3>
      {%- if settings.product_cart_action_enable -%}
      <div class="product-cart-action">
        {% if product.available %}
        {% assign affiliate_link_first = product.description | split:'[/affiliate_link]' | first %}
		{% assign affiliate_link_final = affiliate_link_first | split:'[affiliate_link]' | last %}
        
        {%- if product.description contains '[affiliate_link]' -%}
          <a title="{{ settings.affiliate_cart_button_title }}" href="{{ affiliate_link_final }}" class="">
            <span class="cart-text">{{ settings.affiliate_cart_button_title }}</span>
           </a>
        {%- else -%}
        {%- if settings.product_cart_type == 'ajax_spin_cart' -%}
        {% if product.variants.size == 1 %}
        <a href="javascript:void(0);" onclick="{{ func }}; return false;" class="ajax-spin-cart">
          <span>
            <span class="cart-title">{{ settings.cart_button_title }}</span>
            <span class="cart-loading">{{ settings.wait_title }}</span>
            <span class="cart-added">{{ settings.added_title }}</span>
            <span class="cart-unavailable">{{ settings.unavailable_title }}</span>
          </span>
        </a>
        {% else %}
        <a href="{{ product.url | within: collection }}" class="">
          <span>
            <span class="cart-title">{{ settings.select_options }}</span>
          </span>
        </a>
        {% endif %}
        
        {%- elsif settings.product_cart_type == 'ajax_popup_cart' -%}
        {% if product.variants.size == 1 %}
        <a href="javascript:void(0);" onclick="{{ func }}; return false;" class="">
          <span>
            <span class="cart-title">{{ settings.cart_button_title }}</span>
          </span>
        </a>
        {% else %}
        <a href="{{ product.url | within: collection }}" class="">
          <span>
            <span class="cart-title">{{ settings.select_options }}</span>
          </span>
        </a>
        {% endif %}
        {%- elsif settings.product_cart_type == 'without_ajax_cart' -%}
          {% if product.variants.size == 1 %}
          <a href="javascript:void(0);" onclick="{{ func }}; return false;" class="">
            <span>
              <span class="cart-title">{{ settings.cart_button_title }}</span>
            </span>
          </a>
          {% else %}
          <form action="/cart/add" method="post" enctype="multipart/form-data">
            <select name="id" style="display:none;">
              {% for variant in product.variants %}
              <option value="{{ variant.id }}">{{ variant.title | escape }} - {{ variant.price | money }}</option>
              {% endfor %}
            </select>
            <button type="submit" class="">
              <span>
                <span class="cart-title">{{ settings.cart_button_title }}</span>
              </span>
            </button>
          </form>
          {% endif %}
        {%- endif -%}
        {%- endif -%}
        {%- else -%}
        <button class="cart-disable">
          <span class="cart-text">{{ settings.soldout_button_title }}</span>
        </button>
        {%- endif -%}
      </div>
      {%- endif -%}
    </div>
    <div>
    <div class="price">
      <span id="product_current_price" class="discounted-price" >{{ product.variants.first.price | money }}</span>
      {% if product.variants.first.compare_at_price > product.variants.first.price %}
      <span class="main-price discounted ">{{ product.variants.first.compare_at_price | money }}</span>
      {% endif %}
    </div>
    </div>
    <div class="product-description">
      {%- if product.description contains '[short_description]' -%} 
      {%- assign short_description_first = product.description | split:'[/short_description]' | first -%}
      {%- assign short_description_final = short_description_first | split:'[short_description]' | last -%}
      {{ short_description_final }}
      {%- else -%}
      {{ product.description | split: '[short_description]' | first | split: '[product_description]' | first | split: '[new_products]' | first | split: '[product_video]' | first | split: '[affiliate_link]' | first | split: '[countdown]' | first | split: '[unique_description_1]' | first | split: '[unique_description_2]' | first | split: '[unique_description_3]' | first }}
      {%- endif -%}
    </div>
  </div>

  <!--=======  End of single product content  =======-->
</div>